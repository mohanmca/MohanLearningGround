1. Usage of groupby instead of group by
2. Usage of inner join instead of left-join
3. Missing end while using case